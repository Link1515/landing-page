extends /base.pug
block head
  +css("/css/dashboard.css")
block body
  .w-1024.px-2.px-lg-4.mx-auto.rwd.typeset.heading-contrast
    .text-center.my-4.py-4
      img(src="/assets/img/g0v-only.svg",style="width:3em")
      h1.display-4.font-weight-bold g0v 儀錶板
      .text-muted g0v dashboard    
    hr    
    .text-center
      a#update-time.btn.btn-outline-dark(role="button" href="https://yunlin-teng-437911.middle2.me" target="_blank") 上次更新時間: #[span n/a]
      p.text-center#loading-text 讀取資料中......
    .container.py-4
      .card-columns
        .card#slack-users
          .card-body.text-center
            p.card-text
              span 0
              a(style='font-size: 2em;') +
              br
              | 參與者

        .card#slack-channels
          .card-body.text-center
            p.card-text
              span 0
              | 個
              br
              | slack討論頻道

        .card#slack-messages
          .card-body.text-center
            p.card-text
              span 0
              a(style='font-size: 2em;') +
              br
              a(href='https://join.g0v.tw/', target='_blank') slack討論訊息
        .card#summit-count
          .card-body.text-center
            p.card-text
              span 0
              | 次
              br
              a(href='https://summit.g0v.tw/', target='_blank') 國際雙年會
        .card#hackathon-count
          .card-body.text-center
            p.card-text
              span 0
              | 次
              br
              a(href='https://jothon.g0v.tw/events/', target='_blank') 雙月大黑客松
        .card#hackathon-proposals
          .card-body.text-center
            p.card-text
              span 0
              | 個
              br
              a(href='https://docs.google.com/spreadsheets/d/1C9-g1pvkfqBJbfkjPB0gvfBbBxVlWYJj6tTVwaI5_x8/', target='_blank') 大松提案
        .card#fanpage-like
          .card-body.text-center
            p.card-text
              span 0
              | 人
              br
              a(href='https://www.facebook.com/g0v.tw', target='_blank') 說g0v粉專讚
        .card#fanpage-follow
          .card-body.text-center
            p.card-text
              span 0
              | 人
              br
              a 追蹤g0v粉專
        .card#github-repos
          .card-body.text-center
            p.card-text
              span 0
              a(style='font-size: 2em;') +
              br
              a(href='https://github.com/', target='_blank') github專案
    p.text-center
      | #[a(href="https://github.com/g0v/g0v-dashboard" target="_blank") g0v dashboard] 亦為一個開源專案
block script
  script(src='https://code.jquery.com/jquery-3.5.1.min.js', integrity='sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=', crossorigin='anonymous')
  script(type='text/javascript').            
    $(window).on('load', function(){ 
      $.get("https://yunlin-teng-437911.middle2.me/", function(data){      
        $("#loading-text").fadeOut();
        //console.log(data);
        var date = new Date(data.create_at);
        $("#update-time span").text(date.toLocaleString());
        var titles = Object.keys(data.data);
        titles.forEach((_title) => {
          _data = data.data[_title];
          var subtitles = Object.keys(_data);
          subtitles.forEach((_subtitle) => {
            //console.log(`${_title}-${_subtitle}: ${_data[_subtitle]}`);
            $(`#${_title}-${_subtitle} .card-text span`).text(_data[_subtitle]);
          });      
        });
      });
    });
  
